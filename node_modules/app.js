//  converting to ejs

const express = require("express");
const ejs = require('ejs');
const app = express();
const path = require('path');
app.set('view engine', 'ejs');
app.use(express.urlencoded({ extended: true }));
app.use(express.static('public'));

app.get("/", (req, res) => {
  res.render("home.ejs");
})

app.get("/contactUs", (req, res) => {
  res.render("contactUs.ejs");
})

app.get("/eventsHandler", (req, res) => {
  res.render("eventsHandler.ejs");
})

app.get("/registration", (req, res) => {
  res.render("registration.ejs");
})


//mango code
const mongoose = require('mongoose')

url = 'mongodb://0.0.0.0/Abhisarga'

mongoose.connect(url);

const con = mongoose.connection;

con.on('open', () => {
  console.log("DB connected");
})

con.on('error', (err) => {
  console.log(err);
})




app.post('/registerEvent', (req, res) => {
  let event = {
    Name_of_head: req.body.name,
    Email_Address: req.body.email,
    Phone_Number: req.body.phone,
    Event_Name: req.body.event,
    Comment: req.body.comment,

  }

  con.collection('Events').insertOne(event)
    .then((result) => {
      res.send("Succesfully Added");
    })
    .catch(err=>console.log(err));
})


app.listen("3000", () => {
  console.log("server is running..");
});
